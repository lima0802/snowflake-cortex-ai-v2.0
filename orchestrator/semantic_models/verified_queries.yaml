verified_queries:
- name: TOP_CAMPAIGNS_Q3_ENGAGEMENT
  sql: |
    SELECT
      m.email_name AS campaign_name,
      m.program_or_compaign AS type,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(
        SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0),
        1
      ) AS open_rate_pct,
      ROUND(
        SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0),
        1
      ) AS click_rate_pct,
      ROUND(
        SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0),
        1
      ) AS click_to_open_rate_pct
    FROM
      V_FACT_SFMC_PERFORMANCE_TRACKING f
      LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE
      (
        m.email_name NOT ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND f.send_date >= '2025-07-01'
      AND f.send_date < '2025-10-01'
      AND program_or_compaign = 'Campaign'
    GROUP BY
      m.email_name,
      m.program_or_compaign
    HAVING
      SUM(f.sends) > 100
    ORDER BY
      click_rate_pct DESC
    LIMIT
      10
  question: Which campaign achieved the highest engagement in Q3?
  verified_at: 1770917310
  verified_by: Li Ma
  use_as_onboarding_question: true
- name: MARKET_COMPARISON_FR_ES_IT
  sql: |
    WITH filtered AS (
      SELECT
        f.business_unit,
        f.comp_key,
        f.send_date,
        f.unique_opens,
        f.unique_clicks,
        f.sends,
        f.bounces,
        m.email_name
      FROM
        V_FACT_SFMC_PERFORMANCE_TRACKING f
        INNER JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
      WHERE
        m.email_name NOT ILIKE '%sparkpost%'
        AND f.business_unit IN ('VCFR', 'VCES', 'VCIT')
        AND program_or_compaign = 'Campaign'
    ),
    ranked AS (
      SELECT
        filtered.*,
        ROW_NUMBER() OVER (
          PARTITION BY business_unit
          ORDER BY
            send_date DESC
        ) AS rn
      FROM
        filtered
    )
    SELECT
      c.region_name_group AS region,
      r.business_unit AS market,
      c.country_name AS market_name,
      r.email_name,
      r.send_date AS latest_date,
      ROUND(
        SUM(r.unique_opens) * 100.0 / NULLIF(SUM(r.sends) - SUM(r.bounces), 0),
        1
      ) AS open_rate_pct,
      ROUND(
        SUM(r.unique_clicks) * 100.0 / NULLIF(SUM(r.sends) - SUM(r.bounces), 0),
        1
      ) AS click_rate_pct,
      SUM(r.sends) AS total_sends,
      SUM(r.sends) - SUM(r.bounces) AS total_delivered
    FROM
      ranked r
      INNER JOIN V_DIM_COUNTRY c ON r.business_unit = c.vc_country_code
    WHERE
      r.rn = 1
    GROUP BY
      c.region_name_group,
      r.business_unit,
      c.country_name,
      r.email_name,
      r.send_date
    ORDER BY
      open_rate_pct DESC;
  question: Compare open rates for France, Spain, and Italy for the most recent campaign
  verified_at: 1767123484
  verified_by: Li Ma
  use_as_onboarding_question: true
- name: SPAIN_OPTOUT_VS_EU_Q3
  sql: |
    WITH spain_stats AS (
      SELECT
        c.country_name AS market_name,
        ROUND(
          SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0),
          2
        ) AS unsubscribe_rate_pct,
        SUM(f.sends) AS total_sends
      FROM
        V_FACT_SFMC_PERFORMANCE_TRACKING f
        LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
        INNER JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
      WHERE
        (
          m.email_name NOT ILIKE '%sparkpost%'
          OR m.email_name IS NULL
        )
        AND f.business_unit = 'VCES'
        AND f.send_date >= '2025-07-01'
        AND f.send_date < '2025-10-01'
      GROUP BY
        c.country_name
    ),
    eu_stats AS (
      SELECT
        'EU Average' AS market,
        ROUND(
          SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0),
          2
        ) AS unsubscribe_rate_pct,
        SUM(f.sends) AS total_sends
      FROM
        V_FACT_SFMC_PERFORMANCE_TRACKING f
        LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
        INNER JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
      WHERE
        (
          m.email_name NOT ILIKE '%sparkpost%'
          OR m.email_name IS NULL
        )
        AND c.region_name_group = 'EMEA'
        AND f.send_date >= '2025-07-01'
        AND f.send_date < '2025-10-01'
    )
    SELECT
      *
    FROM
      spain_stats
    UNION ALL
    SELECT
      *
    FROM
      eu_stats
  question: What is Spain's opt-out rate compared to the EU average in Q3?
  verified_at: 1767125252
  verified_by: Li Ma
  use_as_onboarding_question: true
- name: EX30_NL_VS_BE_COMPARISON
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name AS market_name,
      ROUND(
        SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0),
        1
      ) AS open_rate_pct,
      ROUND(
        SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0),
        1
      ) AS click_rate_pct,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered
    FROM
      V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    INNER JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE
      (
        m.email_name NOT ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND f.business_unit IN ('VCNL', 'VCBE')
      AND m.program_or_compaign = 'Campaign'
      AND UPPER(TRIM(m.car_model)) = 'EX30'
    GROUP BY
      c.region_name_group,
      f.business_unit,
      c.country_name
    ORDER BY
      open_rate_pct DESC
  question: Compare open and click rates for EX30 campaigns in NL versus BE
  verified_at: 1767125098
  verified_by: Li Ma
  use_as_onboarding_question: true
- name: HIGH_OPTOUT_MARKETS
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name AS market_name,
      ROUND(
        SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0),
        2
      ) AS unsubscribe_rate_pct,
      SUM(f.sends) AS total_sends,
      SUM(f.unsubscribes) AS total_unsubscribes,
      CASE
        WHEN SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0) > 1.0 THEN 'Critical'
        WHEN SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0) > 0.5 THEN 'Warning'
        ELSE 'OK'
      END AS status
    FROM
      V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    INNER JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE
      (
        m.email_name NOT ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
    GROUP BY
      c.region_name_group,
      f.business_unit,
      c.country_name
    HAVING
      SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0) > 0.5
    ORDER BY
      unsubscribe_rate_pct DESC
  question: Summarize all markets where the opt-out rate exceeds 0.5%
  verified_at: 1767125451
  verified_by: Li Ma
  use_as_onboarding_question: true
- name: PERFORMANCE_SUMMARY_APAC
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND c.region_name_group = 'APEC'
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    ORDER BY total_sends DESC
  question: Show me the email performance summary for Asia Pacific region
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: PERFORMANCE_SUMMARY_LATAM
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND c.region_name_group = 'LATAM'
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    ORDER BY total_sends DESC
  question: Show me the email performance for Latin America
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: PERFORMANCE_SUMMARY_USCAN
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND c.region_name_group = 'US/CAN'
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    ORDER BY total_sends DESC
  question: Show me the email performance for North America
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: REGIONAL_PERFORMANCE_COMPARISON
  sql: |
    SELECT
      c.region_name_group AS region,
      COUNT(DISTINCT f.business_unit) AS num_markets,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY c.region_name_group
    ORDER BY total_sends DESC
  question: How do the different regions compare in email performance?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: MONTHLY_PERFORMANCE_TREND_GLOBAL
  sql: |
    SELECT
      DATE_TRUNC('MONTH', f.send_date) AS month,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.bounces) * 100.0 / NULLIF(SUM(f.sends), 0), 1) AS bounce_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -12, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('MONTH', CURRENT_DATE)
    GROUP BY DATE_TRUNC('MONTH', f.send_date)
    ORDER BY month DESC
  question: What is the monthly performance trend for all email campaigns?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: QUARTERLY_PERFORMANCE_TREND
  sql: |
    SELECT
      DATE_TRUNC('QUARTER', f.send_date) AS quarter,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.bounces) * 100.0 / NULLIF(SUM(f.sends), 0), 1) AS bounce_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('QUARTER', DATEADD('QUARTER', -8, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('QUARTER', CURRENT_DATE)
    GROUP BY DATE_TRUNC('QUARTER', f.send_date)
    ORDER BY quarter DESC
  question: What is the quarterly performance trend?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: WEEK_OVER_WEEK_PERFORMANCE
  sql: |
    SELECT
      CASE
        WHEN f.send_date >= DATE_TRUNC('WEEK', DATEADD('WEEK', -1, CURRENT_DATE))
             AND f.send_date < DATE_TRUNC('WEEK', CURRENT_DATE)
        THEN 'Last Week'
        ELSE 'Previous Week'
      END AS period,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('WEEK', DATEADD('WEEK', -2, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('WEEK', CURRENT_DATE)
    GROUP BY CASE
      WHEN f.send_date >= DATE_TRUNC('WEEK', DATEADD('WEEK', -1, CURRENT_DATE))
           AND f.send_date < DATE_TRUNC('WEEK', CURRENT_DATE)
      THEN 'Last Week'
      ELSE 'Previous Week'
    END
    ORDER BY period DESC
  question: How did last week compare to the week before?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: MONTH_OVER_MONTH_COMPARISON
  sql: |
    SELECT
      CASE
        WHEN f.send_date >= DATE_TRUNC('MONTH', CURRENT_DATE) THEN 'This Month (MTD)'
        ELSE 'Last Month'
      END AS period,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -1, CURRENT_DATE))
    GROUP BY CASE
      WHEN f.send_date >= DATE_TRUNC('MONTH', CURRENT_DATE) THEN 'This Month (MTD)'
      ELSE 'Last Month'
    END
    ORDER BY period DESC
  question: How does this month compare to last month?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: SEND_VOLUME_BY_DAY_OF_WEEK
  sql: |
    SELECT
      DAYNAME(f.send_date) AS day_of_week,
      DAYOFWEEKISO(f.send_date) AS day_num,
      COUNT(DISTINCT f.send_date) AS num_send_days,
      SUM(f.sends) AS total_sends,
      ROUND(AVG(f.sends), 0) AS avg_sends_per_day,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -6, CURRENT_DATE))
    GROUP BY DAYNAME(f.send_date), DAYOFWEEKISO(f.send_date)
    ORDER BY day_num
  question: Which days of the week do we send the most emails?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: TOP_CAMPAIGNS_LAST_QUARTER_ENGAGEMENT
  sql: |
    SELECT
      m.email_name AS campaign_name,
      m.car_model,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('QUARTER', DATEADD('QUARTER', -1, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('QUARTER', CURRENT_DATE)
    GROUP BY m.email_name, m.car_model
    HAVING SUM(f.sends) > 100
    ORDER BY click_to_open_rate_pct DESC NULLS LAST
    LIMIT 10
  question: Which campaign achieved the highest engagement in last quarter?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: TOP_5_CAMPAIGNS_LAST_MONTH
  sql: |
    SELECT
      m.email_name AS campaign_name,
      m.car_model,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      SUM(f.unique_clicks) AS total_unique_clicks,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -1, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('MONTH', CURRENT_DATE)
    GROUP BY m.email_name, m.car_model
    HAVING SUM(f.sends) > 50
    ORDER BY click_rate_pct DESC NULLS LAST
    LIMIT 5
  question: List the top five campaigns by conversion rate in last month
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: TOP_PERFORMING_CAMPAIGNS_OVERALL
  sql: |
    SELECT
      m.email_name AS campaign_name,
      COALESCE(UPPER(TRIM(m.car_model)), 'Not Specified') AS car_model,
      m.program_or_compaign AS campaign_type,
      COUNT(DISTINCT f.business_unit) AS num_markets,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.email_name, m.car_model, m.program_or_compaign
    HAVING SUM(f.sends) > 500
    ORDER BY click_to_open_rate_pct DESC NULLS LAST
    LIMIT 20
  question: What are the top performing campaigns by engagement?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: RECENT_CAMPAIGN_PERFORMANCE
  sql: |
    SELECT
      m.email_name AS campaign_name,
      COALESCE(UPPER(TRIM(m.car_model)), 'Not Specified') AS car_model,
      MIN(f.send_date) AS first_send_date,
      MAX(f.send_date) AS last_send_date,
      COUNT(DISTINCT f.business_unit) AS num_markets,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATEADD('DAY', -30, CURRENT_DATE)
    GROUP BY m.email_name, m.car_model
    ORDER BY first_send_date DESC
  question: What campaigns were sent in the last 30 days and how did they perform?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BOTTOM_PERFORMING_MARKETS
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    HAVING SUM(f.sends) > 1000
    ORDER BY click_to_open_rate_pct ASC NULLS LAST
    LIMIT 10
  question: Which markets have the lowest email engagement?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BOUNCE_RATE_BY_MARKET
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.bounces) AS total_bounces,
      ROUND(SUM(f.bounces) * 100.0 / NULLIF(SUM(f.sends), 0), 1) AS bounce_rate_pct,
      CASE
        WHEN SUM(f.bounces) * 100.0 / NULLIF(SUM(f.sends), 0) > 5 THEN 'Critical - List Cleanup Needed'
        WHEN SUM(f.bounces) * 100.0 / NULLIF(SUM(f.sends), 0) > 2 THEN 'Warning - Monitor'
        ELSE 'Healthy'
      END AS status
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    HAVING SUM(f.sends) > 500
    ORDER BY bounce_rate_pct DESC
  question: Which markets have the highest bounce rates?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: SPAIN_OPTOUT_VS_EU_LAST_QUARTER
  sql: |
    SELECT
      ROUND(SUM(CASE WHEN f.business_unit = 'VCES' THEN f.unsubscribes END) * 100.0 /
            NULLIF(SUM(CASE WHEN f.business_unit = 'VCES' THEN f.sends END), 0), 2) AS spain_unsubscribe_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS eu_avg_unsubscribe_rate_pct,
      ROUND(SUM(CASE WHEN f.business_unit = 'VCES' THEN f.unsubscribes END) * 100.0 /
            NULLIF(SUM(CASE WHEN f.business_unit = 'VCES' THEN f.sends END), 0), 2) -
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS difference_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND c.region_name_group = 'EMEA'
      AND f.send_date >= DATE_TRUNC('QUARTER', DATEADD('QUARTER', -1, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('QUARTER', CURRENT_DATE)
  question: What is Spain's opt-out rate compared to the EU average in last quarter?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: CLICK_RATE_VCUK_MONTHLY
  sql: |
    SELECT
      DATE_TRUNC('MONTH', f.send_date) AS month,
      SUM(f.unique_clicks) AS total_unique_clicks,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.business_unit = 'VCUK'
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -6, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('MONTH', CURRENT_DATE)
    GROUP BY DATE_TRUNC('MONTH', f.send_date)
    ORDER BY month DESC
  question: What is the monthly click rate (clicks divided by sends) for business unit 'VCUK' for the last 6 months?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: PROGRAM_VS_CAMPAIGN_PERFORMANCE
  sql: |
    SELECT
      COALESCE(m.program_or_compaign, 'Unknown') AS email_type,
      COUNT(DISTINCT m.email_name) AS num_emails,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.program_or_compaign
    ORDER BY total_sends DESC
  question: How do Programs compare to Campaigns in performance?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: FIRST_YEAR_PROGRAM_PERFORMANCE
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND m.program_or_compaign = 'Program'
      AND m.program_names ILIKE '%first-year-program%'
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    HAVING SUM(f.sends) > 100
    ORDER BY click_to_open_rate_pct DESC
  question: How is the First Year Program performing?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: ORDER_TO_DELIVERY_PROGRAM_PERFORMANCE
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND m.program_or_compaign = 'Program'
      AND m.program_names ILIKE '%order-to-delivery%'
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    HAVING SUM(f.sends) > 100
    ORDER BY click_to_open_rate_pct DESC
  question: How is the Order to Delivery program performing?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: LEAD_NURTURE_PROGRAM_PERFORMANCE
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND m.program_or_compaign = 'Program'
      AND (m.program_names ILIKE '%lead-nurture%' OR m.program_names ILIKE '%LNP%')
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    HAVING SUM(f.sends) > 100
    ORDER BY click_to_open_rate_pct DESC
  question: How is the Lead Nurture program performing?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: ENEWSLETTER_PERFORMANCE_BY_MARKET
  sql: |
    SELECT
      c.region_name_group AS region,
      f.business_unit AS market,
      c.country_name,
      COUNT(DISTINCT m.email_name) AS num_newsletters,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND m.program_or_compaign = 'E-newsletter'
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    HAVING SUM(f.sends) > 100
    ORDER BY total_sends DESC
  question: How are e-newsletters performing by market?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: DIRECT_ENGINE_VS_ODE_PERFORMANCE
  sql: |
    SELECT
      COALESCE(m.email_send_process, 'Not Specified') AS send_process,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.email_send_process
    ORDER BY total_sends DESC
  question: How does Direct Engine compare to Outside Direct Engine emails?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: PERFORMANCE_BY_EMAIL_SOURCE
  sql: |
    SELECT
      COALESCE(m.email_source, 'Not Specified') AS source,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.email_source
    ORDER BY total_sends DESC
  question: How does Catalyst compare to SFMC as an email source?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: PERFORMANCE_BY_GEOGRAPHIC_SCOPE
  sql: |
    SELECT
      COALESCE(m.geographic_scope, 'Not Specified') AS scope,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.geographic_scope
    ORDER BY total_sends DESC
  question: How do central campaigns compare to local campaigns?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: CAR_MODEL_PERFORMANCE_COMPARISON
  sql: |
    SELECT
      COALESCE(UPPER(TRIM(m.car_model)), 'Not Specified') AS car_model,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY COALESCE(UPPER(TRIM(m.car_model)), 'Not Specified')
    HAVING SUM(f.sends) > 100
    ORDER BY total_sends DESC
  question: How do different car models perform in email campaigns?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: PERFORMANCE_BY_LANGUAGE
  sql: |
    SELECT
      COALESCE(m.email_language, 'Not Specified') AS language,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.email_language
    HAVING SUM(f.sends) > 100
    ORDER BY total_sends DESC
  question: How does email performance vary by language?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: D2C_VS_TRADITIONAL_MARKET_PERFORMANCE
  sql: |
    SELECT
      CASE
        WHEN f.business_unit = 'VCUK' THEN 'D2C (UK)'
        ELSE 'Traditional Markets'
      END AS market_type,
      COUNT(DISTINCT f.business_unit) AS num_markets,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct,
      ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS unsubscribe_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY CASE
        WHEN f.business_unit = 'VCUK' THEN 'D2C (UK)'
        ELSE 'Traditional Markets'
      END
    ORDER BY total_sends DESC
  question: How does UK (D2C market) compare to traditional markets?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: AB_TEST_CAMPAIGN_PERFORMANCE
  sql: |
    SELECT
      CASE WHEN m.ab_testing IS NOT NULL THEN 'AB Test' ELSE 'Non-AB Test' END AS test_type,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY CASE WHEN m.ab_testing IS NOT NULL THEN 'AB Test' ELSE 'Non-AB Test' END
    ORDER BY total_sends DESC
  question: How do AB test campaigns perform?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: EDM_SEQUENCE_PERFORMANCE
  sql: |
    SELECT
      COALESCE(m.email_send_number, 'Not Specified') AS edm_number,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.email_send_number
    HAVING SUM(f.sends) > 100
    ORDER BY edm_number
  question: How do different EDM sends (EDM1, EDM2, etc.) perform?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: COMPLIANT_VS_NON_COMPLIANT_PERFORMANCE
  sql: |
    SELECT
      COALESCE(m.compliant, 'Not Specified') AS compliance_status,
      COUNT(DISTINCT m.email_name) AS num_campaigns,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
    GROUP BY m.compliant
    ORDER BY total_sends DESC
  question: How do compliant emails compare to non-compliant?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: WEEKEND_VS_WEEKDAY_PERFORMANCE
  sql: |
    SELECT
      CASE WHEN DAYOFWEEKISO(f.send_date) IN (6, 7) THEN 'Weekend' ELSE 'Weekday' END AS day_type,
      COUNT(DISTINCT f.send_date) AS num_send_days,
      SUM(f.sends) AS total_sends,
      SUM(f.sends) - SUM(f.bounces) AS total_delivered,
      ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
      ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS click_to_open_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -6, CURRENT_DATE))
    GROUP BY CASE WHEN DAYOFWEEKISO(f.send_date) IN (6, 7) THEN 'Weekend' ELSE 'Weekday' END
    ORDER BY total_sends DESC
  question: How do weekend sends compare to weekday sends?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: AVAILABLE_COUNTRIES_REGIONS
  sql: |
    SELECT
      vc_country_code,
      country_name,
      country_code,
      sub_region,
      region_name_group,
      market_cd
    FROM V_DIM_COUNTRY
    ORDER BY region_name_group, sub_region, country_name
  question: What countries and regions are available in our email marketing database?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: AVAILABLE_CAMPAIGNS_METADATA
  sql: |
    SELECT
      comp_key,
      send_id,
      business_unit,
      email_name,
      email_subject_line,
      car_model,
      program_or_compaign,
      program_names,
      email_source,
      email_send_process,
      geographic_scope,
      email_language,
      email_version,
      send_date
    FROM V_DIM_SFMC_METADATA_JOB
    WHERE email_name NOT ILIKE '%sparkpost%'
    ORDER BY send_date DESC
    LIMIT 1000
  question: What email campaigns and their metadata are available in our system?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BENCHMARK_THRESHOLDS_CTOR
  sql: |
    SELECT
        STATUS,
        STATUS_LABEL,
        CASE
            WHEN MIN_VALUE IS NULL THEN '<' || MAX_VALUE || '%'
            WHEN MAX_VALUE IS NULL THEN '>' || MIN_VALUE || '%'
            ELSE MIN_VALUE || '% - ' || MAX_VALUE || '%'
        END AS threshold_range,
        DESCRIPTION,
        ACTION_REQUIRED
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE METRIC_NAME = 'ctor'
      AND EMAIL_TYPE = 'all'
      AND STATUS != 'info'
    ORDER BY
        CASE STATUS
            WHEN 'critical' THEN 1
            WHEN 'warning' THEN 2
            WHEN 'good' THEN 3
            WHEN 'strong' THEN 4
            WHEN 'excellent' THEN 5
        END
  question: What are the CTOR benchmarks?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BENCHMARK_THRESHOLDS_OPEN_RATE
  sql: |
    SELECT
        STATUS,
        STATUS_LABEL,
        CASE
            WHEN MIN_VALUE IS NULL THEN '<' || MAX_VALUE || '%'
            WHEN MAX_VALUE IS NULL THEN '>' || MIN_VALUE || '%'
            ELSE MIN_VALUE || '% - ' || MAX_VALUE || '%'
        END AS threshold_range,
        DESCRIPTION,
        ACTION_REQUIRED
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE METRIC_NAME = 'open_rate'
      AND EMAIL_TYPE = 'all'
      AND STATUS != 'info'
    ORDER BY
        CASE STATUS
            WHEN 'critical' THEN 1
            WHEN 'warning' THEN 2
            WHEN 'good' THEN 3
            WHEN 'strong' THEN 4
            WHEN 'excellent' THEN 5
        END
  question: What is a good open rate?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BENCHMARK_THRESHOLDS_CLICK_RATE
  sql: |
    SELECT
        STATUS,
        STATUS_LABEL,
        CASE
            WHEN MIN_VALUE IS NULL THEN '<' || MAX_VALUE || '%'
            WHEN MAX_VALUE IS NULL THEN '>' || MIN_VALUE || '%'
            ELSE MIN_VALUE || '% - ' || MAX_VALUE || '%'
        END AS threshold_range,
        DESCRIPTION,
        ACTION_REQUIRED
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE METRIC_NAME = 'click_rate'
      AND EMAIL_TYPE = 'all'
      AND STATUS != 'info'
    ORDER BY
        CASE STATUS
            WHEN 'critical' THEN 1
            WHEN 'warning' THEN 2
            WHEN 'good' THEN 3
            WHEN 'strong' THEN 4
            WHEN 'excellent' THEN 5
        END
  question: What is a good click rate according to industry benchmark?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BENCHMARK_THRESHOLDS_OPTOUT_RATE
  sql: |
    SELECT
        STATUS,
        STATUS_LABEL,
        CASE
            WHEN MIN_VALUE IS NULL THEN '<' || MAX_VALUE || '%'
            WHEN MAX_VALUE IS NULL THEN '>' || MIN_VALUE || '%'
            ELSE MIN_VALUE || '% - ' || MAX_VALUE || '%'
        END AS threshold_range,
        DESCRIPTION,
        ACTION_REQUIRED
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE METRIC_NAME = 'optout_rate'
      AND EMAIL_TYPE = 'all'
      AND STATUS != 'info'
    ORDER BY
        CASE STATUS
            WHEN 'excellent' THEN 1
            WHEN 'strong' THEN 2
            WHEN 'good' THEN 3
            WHEN 'warning' THEN 4
            WHEN 'critical' THEN 5
        END
  question: What is a healthy opt-out rate benchmark?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BENCHMARK_THRESHOLDS_BOUNCE_RATE
  sql: |
    SELECT
        STATUS,
        STATUS_LABEL,
        CASE
            WHEN MIN_VALUE IS NULL THEN '<' || MAX_VALUE || '%'
            WHEN MAX_VALUE IS NULL THEN '>' || MIN_VALUE || '%'
            ELSE MIN_VALUE || '% - ' || MAX_VALUE || '%'
        END AS threshold_range,
        DESCRIPTION,
        ACTION_REQUIRED
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE METRIC_NAME = 'bounce_rate'
      AND EMAIL_TYPE = 'all'
      AND STATUS != 'info'
    ORDER BY
        CASE STATUS
            WHEN 'excellent' THEN 1
            WHEN 'strong' THEN 2
            WHEN 'good' THEN 3
            WHEN 'warning' THEN 4
            WHEN 'critical' THEN 5
        END
  question: What bounce rate is considered acceptable in the industry?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: BENCHMARK_ALL_METRICS_SUMMARY
  sql: |
    SELECT
        METRIC_NAME,
        MAX(CASE WHEN STATUS = 'critical' THEN
            CASE WHEN IS_INVERSE THEN '>' || MIN_VALUE || '%' ELSE '<' || MAX_VALUE || '%' END
        END) AS critical_threshold,
        MAX(CASE WHEN STATUS = 'warning' THEN MIN_VALUE || '% - ' || MAX_VALUE || '%' END) AS warning_threshold,
        MAX(CASE WHEN STATUS = 'good' THEN MIN_VALUE || '% - ' || MAX_VALUE || '%' END) AS good_threshold,
        MAX(CASE WHEN STATUS = 'strong' THEN
            CASE WHEN IS_INVERSE THEN MIN_VALUE || '% - ' || MAX_VALUE || '%' ELSE MIN_VALUE || '% - ' || MAX_VALUE || '%' END
        END) AS strong_threshold,
        MAX(CASE WHEN STATUS = 'excellent' THEN
            CASE WHEN IS_INVERSE THEN '<' || MAX_VALUE || '%' ELSE '>' || MIN_VALUE || '%' END
        END) AS excellent_threshold
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE EMAIL_TYPE = 'all'
      AND STATUS != 'info'
    GROUP BY METRIC_NAME
    ORDER BY METRIC_NAME
  question: Show me all the industry benchmarks
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: EMAIL_TYPE_EXPECTED_BENCHMARKS
  sql: |
    SELECT
        METRIC_NAME,
        MIN_VALUE || '% - ' || MAX_VALUE || '%' AS expected_range,
        DESCRIPTION
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE EMAIL_TYPE = 'program'
      AND STATUS = 'good'
    ORDER BY
        CASE METRIC_NAME
            WHEN 'open_rate' THEN 1
            WHEN 'click_rate' THEN 2
            WHEN 'ctor' THEN 3
        END
  question: What performance should I expect from program emails?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: EMAIL_TYPE_BENCHMARKS_ALL
  sql: |
    SELECT
        EMAIL_TYPE,
        MAX(CASE WHEN METRIC_NAME = 'open_rate' THEN MIN_VALUE || '% - ' || MAX_VALUE || '%' END) AS open_rate_range,
        MAX(CASE WHEN METRIC_NAME = 'click_rate' THEN MIN_VALUE || '% - ' || MAX_VALUE || '%' END) AS ctr_range,
        MAX(CASE WHEN METRIC_NAME = 'ctor' THEN MIN_VALUE || '% - ' || MAX_VALUE || '%' END) AS ctor_range
    FROM CORTEX_SFMC_BENCHMARK_THRESHOLDS
    WHERE STATUS = 'good'
      AND EMAIL_TYPE != 'all'
    GROUP BY EMAIL_TYPE
    ORDER BY EMAIL_TYPE
  question: What are the expected performance ranges for different email types?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: MARKET_PERFORMANCE_VS_INDUSTRY_BENCHMARK
  sql: |
    WITH market_metrics AS (
        SELECT
            c.region_name_group AS region,
            f.business_unit AS market,
            c.country_name,
            SUM(f.sends) AS total_sends,
            ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS ctor_pct
        FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
        LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
        LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
        WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
        GROUP BY c.region_name_group, f.business_unit, c.country_name
        HAVING SUM(f.sends) > 1000
    )
    SELECT
        mm.region,
        mm.market,
        mm.country_name,
        mm.total_sends,
        mm.ctor_pct,
        b.STATUS AS benchmark_status,
        b.STATUS_LABEL,
        b.ACTION_REQUIRED
    FROM market_metrics mm
    INNER JOIN CORTEX_SFMC_BENCHMARK_THRESHOLDS b
        ON b.METRIC_NAME = 'ctor'
        AND b.EMAIL_TYPE = 'all'
        AND b.STATUS IN ('critical', 'warning')
        AND (b.MIN_VALUE IS NULL OR mm.ctor_pct >= b.MIN_VALUE)
        AND (b.MAX_VALUE IS NULL OR mm.ctor_pct < b.MAX_VALUE)
    ORDER BY mm.ctor_pct ASC
  question: Which markets are underperforming vs industry benchmark?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: MARKET_PERFORMANCE_WITH_BENCHMARK_STATUS
  sql: |
    WITH market_metrics AS (
        SELECT
            c.region_name_group AS region,
            f.business_unit AS market,
            c.country_name,
            SUM(f.sends) AS total_sends,
            ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS ctor_pct
        FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
        LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
        LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
        WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
        GROUP BY c.region_name_group, f.business_unit, c.country_name
        HAVING SUM(f.sends) > 1000
    )
    SELECT
        mm.region,
        mm.market,
        mm.country_name,
        mm.total_sends,
        mm.ctor_pct,
        b.STATUS AS benchmark_status,
        b.STATUS_LABEL
    FROM market_metrics mm
    LEFT JOIN CORTEX_SFMC_BENCHMARK_THRESHOLDS b
        ON b.METRIC_NAME = 'ctor'
        AND b.EMAIL_TYPE = 'all'
        AND b.STATUS != 'info'
        AND (b.MIN_VALUE IS NULL OR mm.ctor_pct >= b.MIN_VALUE)
        AND (b.MAX_VALUE IS NULL OR mm.ctor_pct < b.MAX_VALUE)
    ORDER BY mm.ctor_pct DESC
  question: Is our CTOR good compared to industry benchmark?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: REGIONAL_COMPARISON_NO_BENCHMARK
  sql: |
    SELECT
        c.region_name_group AS region,
        f.business_unit AS market,
        c.country_name,
        SUM(f.sends) AS total_sends,
        SUM(f.sends) - SUM(f.bounces) AS total_delivered,
        ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS ctor_pct,
        ROUND(SUM(f.unsubscribes) * 100.0 / NULLIF(SUM(f.sends), 0), 2) AS optout_rate_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.business_unit IN ('VCUK', 'VCDE')
    GROUP BY c.region_name_group, f.business_unit, c.country_name
    ORDER BY ctor_pct DESC
  question: Compare UK vs Germany email performance
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: REGION_COMPARISON_EMEA_VS_APAC
  sql: |
    SELECT
        c.region_name_group AS region,
        COUNT(DISTINCT f.business_unit) AS num_markets,
        SUM(f.sends) AS total_sends,
        ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS ctor_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND c.region_name_group IN ('EMEA', 'APEC')
    GROUP BY c.region_name_group
    ORDER BY ctor_pct DESC
  question: How does EMEA compare to APAC in email performance?
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: HISTORICAL_COMPARISON_MOM
  sql: |
    SELECT
        CASE
            WHEN f.send_date >= DATE_TRUNC('MONTH', CURRENT_DATE) THEN 'This Month (MTD)'
            ELSE 'Last Month'
        END AS period,
        SUM(f.sends) AS total_sends,
        SUM(f.sends) - SUM(f.bounces) AS total_delivered,
        ROUND(SUM(f.unique_opens) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS open_rate_pct,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.sends) - SUM(f.bounces), 0), 1) AS click_rate_pct,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS ctor_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -1, CURRENT_DATE))
    GROUP BY CASE
        WHEN f.send_date >= DATE_TRUNC('MONTH', CURRENT_DATE) THEN 'This Month (MTD)'
        ELSE 'Last Month'
    END
    ORDER BY period DESC
  question: Compare this month vs last month performance
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: HISTORICAL_TREND_6_MONTHS
  sql: |
    SELECT
        DATE_TRUNC('MONTH', f.send_date) AS month,
        SUM(f.sends) AS total_sends,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) AS ctor_pct,
        LAG(ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1))
            OVER (ORDER BY DATE_TRUNC('MONTH', f.send_date)) AS prev_month_ctor,
        ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1) -
            LAG(ROUND(SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0), 1))
            OVER (ORDER BY DATE_TRUNC('MONTH', f.send_date)) AS change_pct
    FROM V_FACT_SFMC_PERFORMANCE_TRACKING f
    LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
    WHERE (m.email_name NOT ILIKE '%sparkpost%' OR m.email_name IS NULL)
      AND f.send_date >= DATE_TRUNC('MONTH', DATEADD('MONTH', -6, CURRENT_DATE))
      AND f.send_date < DATE_TRUNC('MONTH', CURRENT_DATE)
    GROUP BY DATE_TRUNC('MONTH', f.send_date)
    ORDER BY month DESC
  question: Show me the CTOR trend over the last 6 months
  verified_at: 1735500000
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: INTERNAL_AVERAGE_COMPARISON
  sql: |
    WITH market_metrics AS (
      SELECT
        f.business_unit AS market,
        c.country_name,
        SUM(f.sends) AS total_sends,
        ROUND(
          SUM(f.unique_clicks) * 100.0 / NULLIF(SUM(f.unique_opens), 0),
          1
        ) AS ctor_pct
      FROM
        V_FACT_SFMC_PERFORMANCE_TRACKING f
        LEFT JOIN V_DIM_SFMC_METADATA_JOB m ON f.comp_key = m.comp_key
        LEFT JOIN V_DIM_COUNTRY c ON f.business_unit = c.vc_country_code
      WHERE
        (
          m.email_name NOT ILIKE '%sparkpost%'
          OR m.email_name IS NULL
        )
      GROUP BY
        f.business_unit,
        c.country_name
      HAVING
        SUM(f.sends) > 1000
    ),
    overall_avg AS (
      SELECT
        ROUND(AVG(ctor_pct), 1) AS avg_ctor
      FROM
        market_metrics
    )
    SELECT
      mm.market,
      mm.country_name,
      mm.total_sends,
      mm.ctor_pct,
      oa.avg_ctor AS internal_average,
      mm.ctor_pct - oa.avg_ctor AS vs_average,
      CASE
        WHEN mm.ctor_pct < oa.avg_ctor THEN 'Below Average'
        ELSE 'Above Average'
      END AS status
    FROM
      market_metrics mm
      CROSS JOIN overall_avg oa
    WHERE
      mm.ctor_pct < oa.avg_ctor
    ORDER BY
      mm.ctor_pct ASC
  question: Which markets are below our average CTOR?
  verified_at: 1767033999
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me unique block clicks by Link Tracking Alias for all eNewsletter?"'
  sql: |
    SELECT
      a.linktrackingalias AS link_tracking_alias,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
    LEFT OUTER JOIN v_dim_sfmc_alias AS a ON b.alias = a.alias
    LEFT OUTER JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND NOT a.linktrackingalias IS NULL
      AND program_or_compaign = 'E-newsletter'
    GROUP BY
      a.linktrackingalias
    ORDER BY
      total_unique_block_clicks DESC
  question: Show me unique block clicks by Link Tracking Alias for all eNewsletter?
  verified_at: 1769444434
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me unique block clicks by Link Tracking Alias all EX3 CROSS COUNTRY and XC 60 campaigns "'
  sql: |
    SELECT
      m.car_model_format,
      a.linktrackingalias AS link_tracking_alias,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
    LEFT OUTER JOIN v_dim_sfmc_alias AS a ON b.alias = a.alias
    LEFT OUTER JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND NOT a.linktrackingalias IS NULL
      AND m.program_or_compaign = 'Campaign'
      AND UPPER(TRIM(m.car_model_format)) IN ('EX30 CC','XC60 MY26 Refresh')
    GROUP BY
      m.car_model_format,
      a.linktrackingalias
    ORDER BY
      total_unique_block_clicks DESC NULLS LAST
  question: 'Show me unique block clicks by Link Tracking Alias all EX3 CROSS COUNTRY and XC 60 campaigns '
  verified_at: 1769444676
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me Link Tracking Alias hierarchy: Market  Email Name  LTA with unique block clicks"'
  sql: |
    SELECT
      c.country_name AS market,
      m.email_name_cleansed,
      a.linktrackingalias AS link_tracking_alias,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
      LEFT JOIN v_dim_sfmc_alias AS a ON b.alias = a.alias
      LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
      LEFT JOIN v_dim_country AS c ON b.business_unit = c.vc_country_code
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND NOT a.linktrackingalias IS NULL
    GROUP BY
      c.country_name,
      m.email_name_cleansed,
      a.linktrackingalias
    ORDER BY
      total_unique_block_clicks DESC
  question: Show me Link Tracking Alias by Market , Email Name and LTA with unique block clicks
  verified_at: 1769445386
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me unique block clicks by country"'
  sql: |
    SELECT
      c.country_name AS country,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
      LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
      LEFT JOIN v_dim_country AS c ON b.business_unit = c.vc_country_code
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
    GROUP BY
      c.country_name
    ORDER BY
      total_unique_block_clicks DESC
  question: Show me unique block clicks by country
  verified_at: 1769445485
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me unique block clicks by Link Type"'
  sql: |
    SELECT
      a.linktype AS link_type,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
      LEFT JOIN v_dim_sfmc_alias AS a ON b.alias = a.alias
      LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND NOT a.linktype IS NULL
    GROUP BY
      a.linktype
    ORDER BY
      total_unique_block_clicks DESC
  question: Show me unique block clicks by Link Type
  verified_at: 1769445664
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me unique block clicks trend by month"'
  sql: |
    SELECT
      DATE_TRUNC('MONTH', b.min_eventdate) AS month,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
    LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
    GROUP BY
      DATE_TRUNC('MONTH', b.min_eventdate)
    ORDER BY
      month DESC
  question: Show me unique block clicks trend by month
  verified_at: 1769445882
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"What is the total unique block click count across all campaigns?"'
  sql: |
    SELECT
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
      LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND m.program_or_compaign = 'Campaign'
  question: What is the total unique block click count across all campaigns?
  verified_at: 1769446324
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Compare unique block clicks percentage across different Link Tracking Aliases"'
  sql: |
    SELECT
      a.linktrackingalias AS link_tracking_alias,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks,
      ROUND(
        SUM(b.unique_block_clicks) * 100.0 / NULLIF(
          NULLIF(SUM(SUM(b.unique_block_clicks)) OVER (), 0),
          0
        ),
        1
      ) AS percentage
    FROM
      v_fact_sfmc_performance_block AS b
    LEFT JOIN v_dim_sfmc_alias AS a ON b.alias = a.alias
    LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND NOT a.linktrackingalias IS NULL
    GROUP BY
      a.linktrackingalias
    ORDER BY
      total_unique_block_clicks DESC
  question: Compare unique block clicks percentage across different Link Tracking Aliases
  verified_at: 1769446301
  verified_by: Li Ma
  use_as_onboarding_question: false
- name: '"Show me Link Tracking Alias performance for Global eNewsletter in France"'
  sql: |
    SELECT
      a.linktrackingalias AS link_tracking_alias,
      SUM(b.unique_block_clicks) AS total_unique_block_clicks
    FROM
      v_fact_sfmc_performance_block AS b
    LEFT JOIN v_dim_sfmc_alias AS a ON b.alias = a.alias
    LEFT JOIN v_dim_sfmc_metadata_job AS m ON b.comp_key = m.comp_key
    LEFT JOIN v_dim_country AS c ON b.business_unit = c.vc_country_code
    WHERE
      (
        NOT m.email_name ILIKE '%sparkpost%'
        OR m.email_name IS NULL
      )
      AND NOT a.linktrackingalias IS NULL
      AND m.program_or_compaign = 'E-newsletter'
      AND c.vc_country_code = 'VCFR'
    GROUP BY
      a.linktrackingalias
    ORDER BY
      total_unique_block_clicks DESC
  question: Show me Link Tracking Alias performance for Global eNewsletter in France
  verified_at: 1769446390
  verified_by: Li Ma
  use_as_onboarding_question: false